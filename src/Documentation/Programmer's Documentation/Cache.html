<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "DTD/xhtml1-strict.dtd">

<html>
<head>
<title>Cache</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1250" />
</head>
<body>

<h1>Cache</h1>

<h2>Úvod</h2>
<p>Knihovna cachí vytváøí iluzi, že urèitá množina objektù je neustále pøítomna v pamìti, aèkoliv se typicky tyto objekty nemohou do pamìti najednou vejít. Aby této iluze bylo možné dosáhnout, musí mít cachované objekty urèité vlastnosti - musí existovat zpùsob, jak je doèasnì z pamìti odstranit a pak je opìt obnovit ve stejné podobì, v jaké byly pøi odstraòování.</p>

<h2>Cachovaný objekt</h2>
<p>Cachovaným objektem se mùže stát jakýkoliv objekt, který podporuje dvì základní metody - <b>odložení</b> a <b>obnovení</b>. Nahraný objekt zabírá typicky velké množství pamìti. Po odložení se spotøeba pamìti sníží. Jediné, co v pamìti pøetrvá z pùvodního objektu, by mìla být informace, jak objekt obnovit do pùvodního stavu - mùže se jednat o jméno souboru s daty objektu nebo napøíklad o zadání výpoètu, jehož výsledek zabírá mnoho pamìti.</p>
<p>Pokud je objekt odložen, cache by mìla mít informaci o tom, jak velký bude po obnovení. Tato informace nemusí být pøesná, èím je však pøesnìjší, tím lépe mùže cache plánovat využití své pamìti.</p>

<h2>Mechanismus odkládání objektù</h2>
<p>Pøestože cache urèuje, kdy se budou objekty odkládat a obnovovat, musí dodržovat urèitá pravidla. Pokud totiž k nahranému objektu pøistupuje uživatel (ète/modifikuje jeho data), nesmí být takový objekt odložen. Pokud pøijde požadavek na pøístup k objektu, který je momentálnì odložený, cache se snaží jej co nejdøíve obnovit a tento požadavek uspokojit. Snahou cache je, aby objekty byly k dispozici co nejdøíve, a zároveò aby spotøeba pamìti nebyla pøíliš vysoká. Tyto dva požadavky jsou protikladné, cache se snaží najít mezi nimi kompromis pomocí dodateèných informací od uživatele, jako je velikost preferované a maximálnì povolené spotøeby pamìti.</p>
<p><b>Maximální spotøeba pamìti</b> je velikost pamìti, kterou nesmí pøekroèit celková velikost nahraných objektù. Tento požadavek nelze splnit, pokud by uživatel mìl jeden objekt o velikosti vìtší, než je maximální povolená velikost cache. Tento pøípad cache považuje za chybu nastavení. Kromì tohoto patologického pøípadu mohou nastat tøi situace:</p>
<ul>
<li>Pokud je velikost potøebné pamìti menší, než preferovaná velikost, cache neodkládá žádné objekty.</li>
<li>Pokud je potøebná velikost pamìti vìtší než preferovaná velikost, ale menší než maximální, cache se pokusí uvolnit objekty tak, aby se dosáhlo preferované velikost cache. Pokud neuspìje, nový objekt pøesto nahraje bez èekání, a pøebývající nezrušitelné objekty zruší dodateènì, až na nì uživatel pøistupovat pøestane.</li>
<li>Pokud by pøi nahrání požadovaného objektu mìla velikost použité pamìti pøesáhnout maximum, cache se snaží uvolnit dostatek volného místa. Pokud se jí nepodaøí toto volné místo uvolnit (napøíklad proto, že uživatel pøistupuje na mnoho objektù), cache se zastaví a èeká, až uživatel na tyto objekty pøistupovat pøestane, takže je bude možné uvolnit.</li>
</ul>

<h2>Nápovìda pro cache</h2>
<p>Aby cache mohla fungovat co nejlépe, je tøeba urèit vhodný algoritmus, který je schopen urèit, který objekt se vyplatí odložit. Typicky to bývá ten, na který se dlouho nepøistupovalo, takže se pravdìpodobnì na nìj ještì nìjakou dobu pøistupovat nebude. Protože tato strategie nemusí mít dobré výsledky, cache dovoluje uživateli dávat jí nápovìdu a øíci, který objekt pravdìpodobnì bude za chvíli potøeba, a který naopak pravdìpodobnì potøeba dlouho nebude.</p>

<h2>Statistiky</h2>
<p>Cache si drží souhrnné statistické informace o prùbìhu cachování. Ty jsou užiteèné zejména pøi nastavování správných limitù velikosti pamìti. Poèítají se jednotlivé odložení a obnovení objektù a maximální velikost spotøebované pamìti, které bylo dosaženo.</p>

</body>
</html>
