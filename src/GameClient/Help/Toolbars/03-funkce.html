<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "DTD/xhtml1-strict.dtd">
<html>
<head>
<title>Uivatelské nastavení toolbarù</title>
<link rel="StyleSheet" href="../obecny.css" type="text/css" />
<link rel="StyleSheet" href="../hlina.css" type="text/css" />
<meta http-equiv="Content-Type" content="text/html; charset=windows-1250" />
<style type="text/css">
</style>
</head>
<body>

<p class="odkaz">
<a href="02-sekce.html"><img class="sipka" src="../cast-predchozi.png" alt="Pøedchozí èást" /></a>
<a href="02-sekce.html#">Sekce</a>
</p>

<h2 id="funkce_pro_jedno_tlacitko">Funkce pro jedno tlaèítko</h2>

<p>Funkènost kadého tlaèítka zajišuje globální funkce v jazyce <b>TripleS</b>. Napsaná mùe bıt v libovolném zdrojovém souboru a staèí pouze tento soubor pøeloit a aktualizovat. Poté je funkce dostupná pro spuštìní z toolbaru. Kadá takováto funkce má standardní hlavièku:</p>
<pre>
void FuncName ( Client client, Unit selectedunits{},
                &lt;any additional parameters&gt; )

</pre>
<ul>
<li><code><b>client</b></code> je objekt reprezentující klienta, kterı funkci spustil. Pomocí tohoto objektu se funkce mùe uivatele interaktivnì ptát nebo mu posílat textové zprávy. Podrobnosti viz dokumentace k systémovému objektu <a href="../TripleS/11h-systemove_objekty.html#sysobj_client">Client</a>.</li>
<li><code><b>selectedunits</b></code> je mnoina jednotek, které byly na klientovi vybrány pøi spuštìní funkce.</li>
<li>a pak pøídavné parametry definované v sekci jednoho tlaèítka.</li>
</ul>

<p>Pro psaní funkce, platí následující poøadí operací:</p>
<ul>
<li><b>Zpracování parametrù</b> - sem patøí kontrola parametrù a tak podobnì, pøípadnou chybu lze hlásit buï do logu funkcí <code><a href="../TripleS/12-systemove_globalni_funkce.html#WriteToLog">WriteToLog</a></code>, nebo posláním zprávy klientovi funkcí <code><a href="../TripleS/11h-systemove_objekty.html#MessageInfo">Client::Message...()</a></code>.</li>
<li><b>Dotazy na klienta</b> - zjištìní dodateènıch hodnot pro spuštìní funkce. Napøíklad funkce pro pohyb jednotek se zde zeptá na pozici na mapì, kam mají jednotky dojít.</li>
<li><b>Ukonèení práce s klientem</b> - To znamená, e funkce u nebude potøebovat ádné vstupy od klienta. Tato akce se provádí voláním funkce <code><a href="../TripleS/11h-systemove_objekty.html#CloseUserInput">Client::CloseUserInput</a></code>. Po zavolání této funkce se klient uvede do stavu, kdy mùe spouštìt další funkce. Objekt klienta, kterı funkce dostala v parametru se pøepne do reimu, kdy jsou povoleny pouze funkce, které nepotøebují ke svému bìhu klienta, protoe klient se mùe v tuto chvíli odpojit. Jediné funkce, které budou dál fungovat jsou funkce pro posílání zpráv (pokud klient není pøipojen, zpráva se zahodí)</li>
<li><b>Libovolná akce, bez pouití objektu klienta</b> - Funkce pak typicky provede poadovanou akci, pøi které mùe klidnì volat i èekací metody a tak podobnì. Jediné omezení je, e nesmí volat metody na objektu <code><a href="../TripleS/11h-systemove_objekty.html#sysobj_client">Client</a></code>, které vyadují pøipojeného klienta.</li>
</ul>
<p>Dokud funkce nezavolá metodu <code><a href="../TripleS/11h-systemove_objekty.html#CloseUserInput">Client::CloseUserInput</a></code>, mùe bıt v libovolnou chvíli ukonèena. To mùe nastat pokud se klient odpojí, nebo pokud ho odpojí administrátor ze serveru, nebo pokud dojde k chybì v síovém spojení. Funkce by s tím mìla poèítat, a nespouštìt ádné akce, které potøebují nìjakı úklid a podobnì.</p>
<p>Pokud funkce vùbec nezavolá metodu <code><a href="../TripleS/11h-systemove_objekty.html#CloseUserInput">Client::CloseUserInput</a></code>, tato se automaticky zavolá na konci funkce.</p>

<p>Pro skrytá tlaèítka, jako jsou napøíklad ty co jsou spouštìna pøi pravém kliku, je hlavièka funkce trochu odlišná.</p>
<ul>
<li><b>Funkce pouitá v sekci <code>RightClickPosition</code></b> má hlavièku:
<pre>
void FuncName ( Client client, Unit selectedunits{},
                Position clickedposition,
                &lt;any additional parameters&gt; )
</pre>
Parametr <b><code>clickedposition</code></b> obsahuje pozici na mapì, na kterou uivatel kliknul pravım tlaèítkem. Všechny ostatní parametry mají stejnı vıznam jako u normálního tlaèítka.</li>
<li><b>Funkce pouitá v sekci <code>RightClickMyUnit</code> a <code>RightClickEnemyUnit</code></b> má hlavièku:
<pre>
void FuncName ( Client client, Unit selectedunits{},
                Unit clickedunit,
                &lt;any additional parameters&gt; )
</pre>
Parametr <b><code>clickedunit</code></b> obsahuje jednotku, na kterou uivatel kliknul pravım tlaèítkem. Všechny ostatní parametry mají stejnı vıznam jako u normálního tlaèítka.</li>
</ul>

<p class="odkaz">
<a href="02-sekce.html"><img class="sipka" src="../cast-predchozi.png" alt="Pøedchozí èást" /></a>
<a href="02-sekce.html#">Sekce</a>,
</p>

</body>
</html>
